angular.module("Agenvida.controllerReporte",["chart.js"]).controller("controllerReporte",["$scope","$state","$http","$window","$rootScope","$ionicLoading","$sce","$filter",function(o,s,i,t,p,a,r,e){o.labels=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],o.labels2=["Dios","Conmigo","Los Demas","Naturaleza","P.Particular"],o.hoy=new Date,o.vinculaciones=[{id:5,nombre:"Proposito Particular"},{id:1,nombre:"Dios"},{id:2,nombre:"Conmigo"},{id:3,nombre:"Con los Demás"},{id:4,nombre:"Con la Naturaleza"},{id:7,nombre:"Propósitos Semanales"},{id:8,nombre:"Propósitos Mensuales"}],o.mes=("0"+(o.hoy.getMonth()+1)).slice(-2),o.ano=o.date.getFullYear(),o.meses={availableOptions:p.meses_num,selectedOption:o.mes},o.anos={availableOptions:p.anos,selectedOption:o.ano.toString()},o.propositos=JSON.parse(t.localStorage.propositos),o.actualizarReporte=function(){o.propositos_mes=e("filter")(o.propositos,{mes_ano:o.anos.selectedOption+"-"+o.meses.selectedOption+"-"});for(var s=0;s<o.propositos_mes.length;s++){o.propositos_mes[s].positivo=0,o.propositos_mes[s].negativo=0,o.propositos_mes[s].neutro=0,1==o.propositos_mes[s].vinculacion&&(o.propositos_mes[s].vinculacion_nombre="Dios"),2==o.propositos_mes[s].vinculacion&&(o.propositos_mes[s].vinculacion_nombre="Conmigo"),3==o.propositos_mes[s].vinculacion&&(o.propositos_mes[s].vinculacion_nombre="Los Demas"),4==o.propositos_mes[s].vinculacion&&(o.propositos_mes[s].vinculacion_nombre="Naturaleza"),5==o.propositos_mes[s].vinculacion&&(o.propositos_mes[s].vinculacion_nombre="Proposito Particular");for(var i=0;i<o.propositos_mes[s].marcaciones.length;i++)o.marcacion=o.propositos_mes[s].marcaciones[i],1==o.marcacion.cumplimiento?o.propositos_mes[s].positivo=o.propositos_mes[s].positivo+1:2==o.marcacion.cumplimiento?o.propositos_mes[s].negativo=o.propositos_mes[s].negativo+1:o.propositos_mes[s].neutro=o.propositos_mes[s].neutro+1}o.propositos_dios=e("filter")(o.propositos_mes,{vinculacion:1}),o.propositos_conmigo=e("filter")(o.propositos_mes,{vinculacion:2}),o.propositos_losDemas=e("filter")(o.propositos_mes,{vinculacion:3}),o.propositos_naturaleza=e("filter")(o.propositos_mes,{vinculacion:4}),o.propositos_pparticular=e("filter")(o.propositos_mes,{vinculacion:5}),o.maxProposito=[],o.minProposito=[],o.blancoProposito=[];for(var i=0;6>i;i++){o.propositos_aux=e("filter")(o.propositos_mes,{vinculacion:i}),0==i&&(o.propositos_aux=o.propositos_mes),o.maxProposito.push(o.propositos_aux[0]),o.minProposito.push(o.propositos_aux[0]),o.blancoProposito.push(o.propositos_aux[0]);for(var s=1;s<o.propositos_aux.length;s++)o.maxProposito[i].positivo<o.propositos_aux[s].positivo&&(o.maxProposito[i]=o.propositos_aux[s]),o.minProposito[i].negativo<o.propositos_aux[s].negativo&&(o.minProposito[i]=o.propositos_aux[s]),o.totalActual=o.blancoProposito[i].negativo+o.blancoProposito[i].positivo+o.blancoProposito[i].neutro,o.totalNuevo=o.propositos_aux[s].negativo+o.propositos_aux[s].positivo+o.propositos_aux[s].neutro,o.totalActual>o.totalNuevo&&(o.blancoProposito[i]=o.propositos_aux[s])}o.maxPropositoGeneral=o.maxProposito.shift(),o.minPropositoGeneral=o.minProposito.shift(),o.data2=[[]],aux=0;for(var s=0;s<o.propositos_dios.length;s++)aux+=o.propositos_dios[s].positivo;0==o.propositos_dios.length?o.data2[0].push(0):o.data2[0].push(aux/o.propositos_dios.length),aux=0;for(var s=0;s<o.propositos_conmigo.length;s++)aux+=o.propositos_conmigo[s].positivo;0==o.propositos_conmigo.length?o.data2[0].push(0):o.data2[0].push(aux/o.propositos_conmigo.length),aux=0;for(var s=0;s<o.propositos_losDemas.length;s++)aux+=o.propositos_losDemas[s].positivo;0==o.propositos_losDemas.length?o.data2[0].push(0):o.data2[0].push(aux/o.propositos_losDemas.length),aux=0;for(var s=0;s<o.propositos_naturaleza.length;s++)aux+=o.propositos_naturaleza[s].positivo;0==o.propositos_naturaleza.length?o.data2[0].push(0):o.data2[0].push(aux/o.propositos_naturaleza.length),aux=0;for(var s=0;s<o.propositos_pparticular.length;s++)aux+=o.propositos_pparticular[s].positivo;0==o.propositos_pparticular.length?o.data2[0].push(0):o.data2[0].push(aux/o.propositos_pparticular.length)},o.actualizarReporte(),o.getNumber=function(o){return new Array(o)}}]);