!function(t){for(var i=document.createElement("div"),n=["webkitTransformOrigin","transform-origin","-webkit-transform-origin","webkit-transform-origin","-moz-transform-origin","moz-transform-origin","MozTransformOrigin","mozTransformOrigin"],e="webkitTransformOrigin",r=0;r<n.length;r++)if(void 0!==i.style[n[r]]){e=n[r];break}for(var s=["webkitTransition","transition","-webkit-transition","webkit-transition","-moz-transition","moz-transition","MozTransition","mozTransition"],o="webkitTransition",r=0;r<s.length;r++)if(void 0!==i.style[s[r]]){o=s[r];break}var a=t.views.View.inherit({initialize:function(t){this.cards=[];window.innerWidth/window.innerHeight;this.maxWidth=window.innerWidth-(t.cardGutterWidth||0),this.maxHeight=t.height||300,this.cardGutterWidth=t.cardGutterWidth||10,this.cardPopInDuration=t.cardPopInDuration||400,this.cardAnimation=t.cardAnimation||"pop-in"},pushCard:function(t){var i=this;this.cards.push(t),this.beforeCardShow(t),t.transitionIn(this.cardAnimation),setTimeout(function(){t.disableTransition(i.cardAnimation)},this.cardPopInDuration+100)},beforeCardShow:function(){var t=this.cards[this.cards.length-1];if(t){window.innerHeight/2-this.maxHeight/2,5*Math.min(this.cards.length,3);t.setPopInDuration(this.cardPopInDuration),t.setZIndex(this.cards.length)}},popCard:function(t){var i=this.cards.pop();return t&&i.swipe(),i}}),h=t.views.View.inherit({initialize:function(i){i=t.extend({},i),t.extend(this,i),this.el=i.el,this.startX=this.startY=this.x=this.y=0,this.bindEvents()},setX:function(i){this.el.style[t.CSS.TRANSFORM]="translate3d("+i+"px,"+this.y+"px, 0)",this.x=i,this.startX=i},setY:function(i){this.el.style[t.CSS.TRANSFORM]="translate3d("+this.x+"px,"+i+"px, 0)",this.y=i,this.startY=i},setZIndex:function(t){this.el.style.zIndex=t},setWidth:function(t){this.el.style.width=t+"px"},setHeight:function(t){this.el.style.height=t+"px"},setPopInDuration:function(t){this.cardPopInDuration=t},transitionIn:function(t){var i=this;this.el.classList.add(t+"-start"),this.el.classList.add(t),this.el.style.display="block",setTimeout(function(){i.el.classList.remove(t+"-start")},100)},disableTransition:function(t){this.el.classList.remove(t)},swipe:function(){this.transitionOut()},transitionOut:function(){var i=this;if(this.y<0)this.el.style[o]="-webkit-transform 0.2s ease-in-out",this.el.style[t.CSS.TRANSFORM]="translate3d("+this.x+","+this.startY+"px, 0)",setTimeout(function(){i.el.style[o]="none"},200);else{var n=this.rotationAngle+.6*this.rotationDirection||.4*Math.random(),e=this.rotationAngle?.2:.5;this.el.style[o]="-webkit-transform "+e+"s ease-in-out",this.el.style[t.CSS.TRANSFORM]="translate3d("+this.x+","+1.5*window.innerHeight+"px, 0) rotate("+n+"rad)",this.onSwipe&&this.onSwipe(),setTimeout(function(){i.onDestroy&&i.onDestroy()},1e3*e)}},bindEvents:function(){var i=this;t.onGesture("dragstart",function(n){var e=window.innerWidth/2;n.gesture.touches[0].pageX<e?i._transformOriginRight():i._transformOriginLeft(),t.requestAnimationFrame(function(){i._doDragStart(n)})},this.el),t.onGesture("drag",function(n){t.requestAnimationFrame(function(){i._doDrag(n)})},this.el),t.onGesture("dragend",function(n){t.requestAnimationFrame(function(){i._doDragEnd(n)})},this.el)},_transformOriginLeft:function(){this.el.style[e]="left center",this.rotationDirection=1},_transformOriginRight:function(){this.el.style[e]="right center",this.rotationDirection=-1},_doDragStart:function(t){var i=this.el.offsetWidth,n=window.innerWidth/2+this.rotationDirection*(i/2),e=Math.abs(n-t.gesture.touches[0].pageX);this.touchDistance=10*e},_doDrag:function(i){var n=i.gesture.deltaY/3;this.rotationAngle=Math.atan(n/this.touchDistance)*this.rotationDirection,i.gesture.deltaY<0&&(this.rotationAngle=0),this.y=this.startY+.4*i.gesture.deltaY,this.el.style[t.CSS.TRANSFORM]="translate3d("+this.x+"px, "+this.y+"px, 0) rotate("+(this.rotationAngle||0)+"rad)"},_doDragEnd:function(t){this.transitionOut(t)}});angular.module("ionic.contrib.ui.cards",["ionic"]).directive("swipeCard",["$timeout",function(t){return{restrict:"E",template:'<div class="swipe-card" ng-transclude></div>',require:"^swipeCards",transclude:!0,scope:{onCardSwipe:"&",onDestroy:"&"},link:function(i,n,e,r){var s=n[0],o=new h({el:s,onSwipe:function(){t(function(){i.onCardSwipe()})},onDestroy:function(){t(function(){i.onDestroy()})}});i.$parent.swipeCard=o,r.swipeController.pushCard(o)}}}]).directive("swipeCards",["$rootScope",function(t){return{restrict:"E",template:'<div class="swipe-cards" ng-transclude></div>',transclude:!0,scope:!0,controller:["$scope","$element",function(i,n){var e=new a({});t.$on("swipeCard.pop",function(t){e.popCard(t)}),this.swipeController=e}]}}]).factory("$ionicSwipeCardDelegate",["$rootScope",function(t){return{popCard:function(i,n){t.$emit("swipeCard.pop",n)},getSwipeableCard:function(t){return t.$parent.swipeCard}}}])}(window.ionic);